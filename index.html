<!DOCTYPE HTML>
<html lang="us">
<head>
    <meta charset="utf-8">
    
    <title>WAVED</title>
    <link rel="icon" href="images/favicon.ico" type="image/x-icon" />
    
    <!-- CSS -->
    <link rel="stylesheet" href="ThirdParty/jquery/css/waved-theme/jquery-ui-1.10.4.custom.min.css">
    <link rel="stylesheet" type="text/css" href="CSS/WAVED.css">
    
    <!-- JavaScript-->
    <!-- <script src="ThirdParty/d3/d3.v3.min.js" type="text/javascript" type="text/javascript"/> -->
    <script data-main="Source/main" src="ThirdParty/requirejs/require.js"></script>
</head>
<body>
    <div id="mainSection" class="hide-on-load">
        <div id="header-container">
                <div class="inline bottom" id="header-logo-container">
                    <a href="http://kshsk.github.io/WAVED/" target="_blank">
                        <img id="header-logo" src="images/logo/WAVED_HighRes_Color_NoText.png" ondragstart="return false;" />
                    </a>
                </div>
                <div class="inline bottom">
                    <div class="menu-text" id="project-name" data-bind="text: currentProject.name"></div>
                    <button class="inline" id="new-button" data-bind="click: tryToCreateNewProject">New</button>
                    <button class="inline" id="load-button" data-bind="click: tryToLoadProject">Load</button>

                    <button class="inline" id="undo-button">Undo</button>
                    <button class="inline" id="redo-button">Redo</button>
                
                    <button class="inline" id="save-button">Save</button>
                    <button class="inline" id="export-button">Export</button>
                
                    <span class="menu-text">Select: </span>
                    <select class="inline" 
                            id="widget-select" 
                            data-bind="options: currentProject.components, 
                                optionsText: function(item) {
                                   return item.viewModel.name.value;
                                }, value: selectedWidget">
                    </select>
                    <button class="inline" id="refresh-button">Refresh</button>
                </div>                
        </div>
        
        <div id="accordion-container" class="inline top">
            <div id="accordion">
                <h3>Project Tree</h3>
                <div id="project-tree">
                    // Project Tree
                </div>
                <h3>Widgets</h3>
                <div id="widgets-panel" data-bind="foreach: availableWidgets">
                    <button data-bind="text: $data.name, click: $parent.addNewWidget"></button>
                </div>
                <h3>Data</h3>
                <div>
                    <div>
                        <div>
                            <div class="inline">Source Files</div>
                            <div class="inline right">
                                <button id="add-data-file-button" class="button-small" data-bind="click: tryToLoadData">Add Data File</button>
                                <button id="delete-data-file-button" class="button-small">Delete Data File</button>
                            </div>
                        </div>
                        <select id="data-file-list" size="5" class="select-full-size"
                            data-bind="options: currentProject.dataSets, 
                                optionsText: function(item) {
                                   return item.name + ' : ' + item.filenameOnly;
                                }, value: selectedDataSet"></select>
                    </div>
                    <br />
                    <div>
                        <div>
                            <div class="inline">Data Subsets</div>
                            <div class="inline right">
                                <button id="add-data-subset-button" class="button-small">Add Data Subset</button>
                                <button id="edit-data-subset-button" class="button-small">Edit Data Subset</button>
                                <button id="delete-data-subset-button" class="button-small">Delete Data Subset</button>
                            </div>
                        </div>
                        <select id="data-subset-list" size="5" class="select-full-size"></select>
                    </div>
                </div>
                <h3>Actions</h3>
                <div>
                    <div>
                        <div>
                            <div class="inline">Actions</div>
                            <div class="inline right">
                                <button id="add-action-button" class="button-small">Add Action</button>
                                <button id="edit-action-button" class="button-small">Edit Action</button>
                                <button id="delete-action-button" class="button-small">Delete Action</button>
                            </div>
                        </div>
                        <select id="action-list" size="10" class="select-full-size"></select>
                    </div>
                </div>
                <h3>Events</h3>
                <div>
                    <div>
                        <div>
                            <div class="inline">Events</div>
                            <div class="inline right">
                                <button id="add-event-button" class="button-small">Add Event</button>
                                <button id="edit-event-button" class="button-small">Edit Event</button>
                                <button id="delete-event-button" class="button-small">Delete Event</button>
                            </div>
                        </div>
                        <select id="event-list" size="10" class="select-full-size"></select>
                    </div>
                </div>
                <h3>Properties</h3>
                <div id="properties-panel">
                    <div id="properties-panel-properties" data-bind="foreach: currentProject.components">
                        <div data-bind="foreach: $data.viewModel.properties, visible: $parent.selectedWidget == $data">
                            <div data-bind="template: {name : $data.templateName, data: $data}"></div>
                        </div>
                    </div>
                    <div id="properties-panel-bound-data" data-bind="visible: selectedWidget && selectedWidget.viewModel.boundData !== 'undefined'">                        
                        <div data-bind="visible: selectedWidget && typeof selectedWidget.viewModel.boundData !== 'undefined'">
                            <hr/>
                            <div class="inline">Bound Data</div>
                            <div class="inline right">
                                <button id="bind-data-button" data-bind="click: tryToBindData" class="button-small">Bind Data</button>
                                <button id="unbind-data-button" data-bind="click: unbindData" class="button-small">Unbind Data</button>
                            </div>
                        
                            <div data-bind="if: selectedWidget && typeof selectedWidget.viewModel.boundData !== 'undefined'">
                                <select id="bound-data-list" size="5" class="select-full-size"
                                    data-bind="options: selectedWidget.viewModel.boundData, 
                                        optionsText: function(name) {
                                           return name + ' : ' + currentProject.getDataSet(name).filenameOnly;
                                        }, value: selectedBoundData">
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <h3>Google Analytics</h3>
                <div>
                    <div>
                        <div class="inline" id="google-analytics-unbound">
                            <label for="google-analytics-ua" class="inline">Google Analytics UA Code</label>
	                        <input type="text" id="google-analytics-ua" class="validate" 
                               data-min-length="1" 
                               data-match="^((UA)(-)(\d+)(-)(\d+)){1}$" 
                               data-match-modifier="i" 
                               data-match-desc="UA code is not in the correct format. It should look like UA-####-##." />
	                        <div id="google-analytics-ua-error" class="error"></div>
	                        <label for="google-analytics-category" class="inline">Google Analytics Event Category</label>
	                        <input type="text" id="google-analytics-category" class="validate" 
	                           data-min-length="1" 
	                           data-match="^[a-zA-Z0-9_\- ]+$" 
	                           data-match-modifier="i" 
	                           data-match-desc="May only contain alphanumerics, hypens (-), underscores(_) and spaces."/>
	                        <div id="google-analytics-category-error" class="error"></div>
	                        <div id="google-analytics-add-button-panel" class="submit-button-panel">
	                           <button id="google-analytics-add-button" class="button-small submit-button" data-ng-click="addGoogleAnalytics();">Add</button>
	                           <button id="google-analytics-clear-button" class="button-small" data-ng-click="clearGoogleAnalyticsFields();">Clear</button>
                            </div>
                        </div>
                        <div class="inline" id="google-analytics-bound" style="display:none;">
                            <span>UA: </span><span id="google-analytics-ua-preview"></span>
                            <br>
                            <span>Event Category: </span><span id="google-analytics-category-preview"></span>
                            <div id="google-analytics-remove-button-panel">
                                <button id="google-analytics-remove-button" class="button-small" data-ng-click="removeGoogleAnalytics();" style="float:center;">Remove</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="workspace-container" class="inline top">
            <div id="waved-workspace" data-bind="style: {height: currentProject.workspace.height.value + 'px', width: currentProject.workspace.width.value + 'px'}">
            </div>
        </div>
        
    </div>
    
    <!-- The dialogs need to be outside the hidden section or they are not created correctly. -->
    <div id="welcome-dialog" title="Welcome to WAVED!" class="dialog">
        <p>Would you like to create a new project or load an existing one?</p>
    </div>
    
    <div id="create-new-project-dialog" title="New Project" class="dialog">
        <p>Please create a new project</p>
        <label class="required" for="create-new-project-name">Project Name: </label>
        <input id="create-new-project-name" type="text"/>
        <p id="create-new-project-error" class="error"></p>
    </div>
    
    <div id="load-project-dialog" title="Load Project" class="dialog">
        <p>Please select an existing project to load.</p>
        <label class="required" for="load-project-select">Project Name: </label>
        <select id="load-project-select"
            data-bind="options: projectList, value: projectToLoad">
        </select>
        <button id="load-project-refresh-list" class="button-small" data-bind="click: updateProjectList">Refresh List</button>
        <p id="load-project-error" class="error"></p>
    </div>
    
    <div id="upload-data-dialog" title="Upload Data" class="dialog">
        <label class="required" for="upload-data-name">Name: </label>
        <input id="upload-data-name" type="text"/>
        <p id="upload-data-name-error" class="error"></p>
        
        <label class="required" for="upload-data-file">File: </label>
        <input id="upload-data-file" type="file"/>
        <p id="upload-data-file-error" class="error"></p>
    </div>
    
    <div id="bind-data-dialog" title="Bind Data" class="dialog">
        <table>
            <thead>
                <tr>
                    <th>Inlcude</th>
                    <th>Name</th>
                    <th>File</th>
                </tr>
            </thead>
            <tbody id="bind-data-options" data-bind="foreach: currentProject.dataSets">
                <tr>
                    <td>
                        <input type="checkbox" class="bind-data-selections"
                            data-bind="attr: {'data-name': $data.name}" />
                    </td>
                    <td data-bind="text: $data.name"></td>
                    <td data-bind="text: $data.filenameOnly"></td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <div id="unsaved-changes-dialog" title="Unsaved Changes" class="dialog">
        <p>You have unsaved changes. Please discard your changes or cancel to continue working with the current project.</p>
    </div>
    
    <div id="error-dialog" title="" class="dialog">
        <p id="error-dialog-message"></p>
    </div>
    
    <script type="text/html" id="stringPropertyTemplate">
        <div>
            <span data-bind="text:displayName"></span>
            <input type="text" data-bind="value:value"></input>
        </div>
    </script>
    <script type="text/html" id="numberPropertyTemplate">
        <div>
            <span data-bind="text:displayName"></span>
            <input type="text" data-bind="value:value"></input>
        </div>
    </script>
    <script type="text/html" id="arrayPropertyTemplate">
        <div>
            <span data-bind="text:displayName"></span>
            <input type="text" data-bind="value:value"></input>
        </div>
    </script>
    <script type="text/html" id="booleanPropertyTemplate">
        <div>
            <input type="checkbox" data-bind="checked:value"></input>
            <span data-bind="text:displayName"></span>
        </div>
    </script>
    <script type="text/html" id="buttonTemplate">
        <button class="widget" data-bind="text:label.value, 
            style:{left: x.value + '%', top: y.value+'%', height: height.value + '%', width: width.value + '%'},
            visible: visible.value" style="position: relative"></buttton>
    </script>
</body>
</html> 
